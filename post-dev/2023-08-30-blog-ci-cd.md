---
slug: 2023-08-30-essence-of-oop
title: ë¸”ë¡œê·¸ ìë™ë°°í¬ ë„ì…ê¸°
summary: CI/CD? ì œê°€ í•œë²ˆ í•´ë³¼ê²Œìš”.
author: Sanghun lee
date: 2023-08-30 11:33:00 +0800
categories: [CI/CD]
folder: [post-dev]
tags: [CI/CD]
math: true
mermaid: true
image:
  src: '../static/images/posts/blog-ci-cd/ci-cd.png'
  height: 585
---

# ì‹œì‘í•˜ê²Œ ëœ ì´ìœ 

ë°”ë‹ë¼ ìë°”ìŠ¤í¬ë¦½íŠ¸ ê³µë¶€ë¥¼ í•œë‹¤ëŠ” í•‘ê³„ë¡œ ë¸”ë¡œê·¸ë¥¼ ì§ì ‘ ë§Œë“¤ì–´ ì‚¬ìš©í•œì§€ ì–´ì–¸ 1ë…„ì´ ë„˜ì–´ê°€ëŠ” ì‹œì ì´ì—ˆë‹¤.

ì–¸ì  ê°€ ìë™ë°°í¬ ì ìš©ì„ í•´ì•¼ì§€!ë¼ê³  ìƒê°ì •ë„ëŠ” í•˜ê³  ìˆì—ˆìœ¼ë‚˜, í„°ë¯¸ë„ì—ì„œ ë“¤ì–´ê°€ì„œ ì—…ë°ì´íŠ¸í•˜ëŠ”ê²Œ ê°œì¸ì ìœ¼ë¡œ ê·¸ë ‡ê²Œ ê·€ì°®ì€ ì‘ì—…ìœ¼ë¡œ ë°›ì•„ë“¤ì—¬ì§€ì§€ ì•Šì•„ì„œ í•„ìš”ë¥¼ ì²´ê°í•˜ì§€ ëª»í–ˆë˜ ê²ƒ ê°™ë‹¤.

ê·¸ë˜ë„ ë¸”ë¡œê·¸ ë‚´ì— ê¸€ì„ ê³„ì† ì“°ë ¤ë‹¤ë³´ë‹ˆ ì—…ë°ì´íŠ¸ë¥¼ í•˜ëŠ” ê²ƒì— ê·€ì°®ìŒì´ ëŠê»´ì ¸ ì œëŒ€ë¡œ í•œë²ˆ ì§„í–‰í•´ë³´ë ¤ê³  **Github Actions**ë¥¼ í™œìš©í•´ë³´ê¸°ë¡œ í–ˆë‹¤.

ë‚´ [ë¸”ë¡œê·¸ ë ˆí¬ì§€í† ë¦¬](https://github.com/sanghunlee-711/Cloud-Vanilla-Blog)ëŠ” ê³µê°œ ë ˆí¬ì¸ì§€ë¼ actionsê°€ ë¬´ë£Œì´ë‹¤.

ê·¸ë˜ì„œ ì–´ë–¤ë°©ì‹ìœ¼ë¡œ ì´ê²ƒì„ ì§„í–‰í•˜ë©´ ì¢‹ì„ê¹Œ ìƒê°í•´ë³´ì•˜ì„ ë•Œ ë‚´ê°€ í„°ë¯¸ë„ì„ í†µí•´ í•´ë‹¹ ì„œë²„ì—ì„œ ì‘ì„±í•˜ëŠ” ì»¤ë§¨ë“œë¥¼ ìš°ì„  ì •ë¦¬í•˜ì˜€ë‹¤.

# 1. í–‰ìœ„ ì •ë¦¬

```md
1. .pemíŒŒì¼ì„ í†µí•´ sshë¡œ í•´ë‹¹ ec2 ì¸ìŠ¤í„´ìŠ¤ì— ì ‘ì†í•œë‹¤
2. rootí´ë”ì—ì„œ `cd /home/ubuntu/Cloud-Vanilla-Blog/`ë¡œ í•´ë‹¹í´ë”ë¡œ ì´ë™
3. `git pull origin main` gitìœ¼ë¡œ ì—…ë°ì´íŠ¸ëœ ì½”ë“œ ê°€ì ¸ì˜¤ê¸°
4. `npm i` íŒ¨í‚¤ì§€ ì—…ë°ì´íŠ¸
5. `pm2 kill` pm2 ì ì‹œ ë©ˆì¶¤(api)
6. `npm run build:deploy` ë°°í¬ ë¹Œë“œ
7. `pm2 start npm -- run start` pm2 ë‹¤ì‹œ ì‹œì‘
```

ìœ¼ë¡œ í–‰ìœ„ê°€ ì •ë¦¬ë˜ì—ˆë‹¤. ì´ì œ ì´ê²ƒì„ ì–´ë–»ê²Œ ìë™ìœ¼ë¡œ ì‹¤í˜„ì‹œí‚¤ë‚˜ê°€ ê´€ê±´ì´ ë˜ì—ˆë‹¤.

ê²€ìƒ‰ì„ í•´ë³¸ê²°ê³¼ íŠ¹ì • `uses` ë¥¼ ì„¤ì •í•´ì£¼ë©´ ì˜¤í”ˆì†ŒìŠ¤ì—ì„œ ì œê³µí•´ì£¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ì•Œì•„ì„œ ë‹¤ í•´ì£¼ê³ .. ìœ„ì— ì •ë¦¬ëœ ìŠ¤í¬ë¦½íŠ¸ë§Œ ìˆœì„œëŒ€ë¡œ ë‚˜ì—´í•˜ë©´ ë  ê²ƒ ê°™ì•˜ë‹¤.

# 2. ì‹œë„

ì¼ë‹¨ workflowì‚¬ìš©ì„ ìœ„í•´ì„œëŠ” ymlíŒŒì¼ì„ ë£¨íŠ¸í´ë”ë‚´ì— `.github`í´ë”ì— ë„£ì–´ì¤˜ì•¼í•œë‹¤.

ì•„ë˜ ì‚¬ì§„ê³¼ ê°™ì´ íŒŒì¼ì„ ë§Œë“¤ì–´ì£¼ë©´ ëœë‹¤.

![í´ë”êµ¬ì¡°](/static/images/posts/blog-ci-cd/folder.png)

ì—¬ê¸°ì €ê¸° ê²€ìƒ‰ì„ í†µí•´ ì˜¤í”ˆì†ŒìŠ¤ë¥¼ ì‚¬ìš©í•˜ëŠ” ssh ì—°ê²°ë°©ë²•ì´ ìˆê¸°ì— ê·¸ í¬ìŠ¤íŠ¸ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì»¤ë§¨ë“œë¥¼ ì§œë ¤ê³  ì•„ë˜ì™€ ê°™ì´ ì‘ì„±í•´ë³´ì•˜ë‹¤.

```yml
# main.yml
name: main branch auto ci process script

on: # ì•„ë˜ jobì„ ì‹¤í–‰ì‹œí‚¬ ìƒí™©
  push:
    branches: [main] # mainë¸Œëœì¹˜ í‘¸ì‰¬ ë°›ìœ¼ë©´ ì‘ë™

jobs: # ì‘ë™í•  ì¼
  deploy:
    name: deploy #github ì•„ì´ì½˜ì— ë‚˜íƒ€ë‚  ê³¼ì • ì´ë¦„
    runs-on: ubuntu-latest # ì‹¤í–‰ë  ì¸ìŠ¤í„´ìŠ¤ OSì™€ ë²„ì „

    steps:
      - name: excuting remote ssh commands # ê° ë‹¨ê³„ ì´ë¦„
        uses: appleboy/ssh-action@v0.1.6 # ssh ì ‘ì†í•˜ëŠ” ì˜¤í”ˆì†ŒìŠ¤
        with:
          host: ${{ secrets.REMOTE_IP }} # ì¸ìŠ¤í„´ìŠ¤ IP
          username: ${{ secrets.REMOTE_ID }} # ìš°ë¶„íˆ¬ ì•„ì´ë”” ë‚œ ubuntuì„
          key: ${{ secrets.REMOTE_PEM }} # ec2 pem key
          port: ${{ secrets.REMOTE_SSH_PORT }} # ì ‘ì†í¬íŠ¸
          script: | # ì‹¤í–‰í•  ìŠ¤í¬ë¦½íŠ¸
            cd /home/ubuntu/Cloud-Vanilla-Blog/
            git pull origin main
            npm i
            pm2 kill
            npm run build:deploy
            pm2 start npm -- run start
```

ê·¸ë¦¬ê³  githubì— secrets.XXX ì™€ ê´€ë ¨ëœ ê°’ë“¤ì„ ë„£ì–´ì£¼ì—ˆê³ , usernameê³¼ portê°€ ì˜ë¯¸í•˜ëŠ” ê²ƒì´ í—·ê°ˆë ¸ìœ¼ë‚˜ usernameì€ ubuntu, portëŠ” 22ë¡œ sshë¥¼ í†µí•´ ì ‘ì†í•˜ëŠ” ì»¤ë§¨ë“œ `ssh -i xxx.pem ubuntu@xx.xxx.xxx.xxx`ì— ì´ë¦„ì— ëŒ€í•œ ì •ë‹µì´ìˆì—ˆë‹¤.

ê·¸ë¦¬ê³  ë³´í†µ ssh ì ‘ì†ì€ 22í¬íŠ¸ë¡œ ì§„í–‰ë˜ë¯€ë¡œ ì´ë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ë©´ ë˜ì—ˆë‹¤.

_ê·¸ëŸ°ë° ë§‰ìƒ í•´ë‹¹ ì»¤ë§¨ë“œë¥¼ ì ìš©í•˜ì—¬ ì‹œë„ë¥¼ í•´ë³´ë‹ˆ timeoutì—ëŸ¬ê°€ ë°œìƒí•˜ì˜€ë‹¤_

ë”°ë¼ì„œ, ìœ ì‚¬ ì—ëŸ¬ì½”ë“œë¥¼ ê²€ìƒ‰í•´ì„œ ê¹ƒí—™ì´ìŠˆë¥¼ í™•ì¸í•´ë³´ì•˜ê³ , ë²„ì „ë¬¸ì œë¼ëŠ” ì´ìŠˆ ë•ë¶„ì— ì¬ë¹ ë¥´ê²Œ ë²„ì „ë§Œ ë³€ê²½í•´ì„œ ì§„í–‰í•´ë³´ì•˜ë‹¤.(0.1.6 â€”> 0.1.9)

ì•„ì‰½ê²Œë„ í•´ë‹¹ ë¬¸ì œëŠ” í•´ê²°ë˜ì§€ ì•Šì•˜ê³ , issueë¥¼ ë˜ ì°¾ì•„ë³´ë‹ˆ `ë„ˆê°€ secretsë¥¼ ì˜ëª» ë„£ì–´ì„œ ê·¸ëŸ°ê±¸ ìˆ˜ë„ ìˆì–´!` ë¼ê³  í•˜ì—¬ ë‹¤ì‹œ ê°’ë“¤ì„ ì¬ ì„¤ì •í•´ë³´ì•˜ë‹¤.

ê·¸ëŸ¼ì—ë„ ì›í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ì‘ë™ì´ ë˜ì§€ ì•Šì•˜ê³ .. ì´ì œ ìƒê°ì´ë¼ëŠ” ê²ƒì„ í•´ë³´ê¸°ë¡œ í•˜ì˜€ë‹¤.

ì—¬ê¸°ì„œ ë³´ì•ˆ ë¬¸ì œì¼ ìˆ˜ë„ ìˆê² ë‹¤ëŠ” íŒíŠ¸ë¥¼ ì–»ê²Œ ë˜ì—ˆë‹¤.

- secretsê°€ ì˜ëª»ë˜ì–´ì„œ timeoutì´ ë‚œê±°ë¼ë©´
- sshë¡œ ì˜ ì ‘ì†ì´ ë¬¸ì œê°€ ë˜ëŠ” ê²ƒì¸ë° ê·¸ë ‡ë‹¤ë©´ ë³´ì•ˆê·¸ë£¹ì´ ë¬¸ì œì¼ ìˆ˜ë„ ìˆì„ ê²ƒ ê°™ë‹¤
- **ê·¸ëŸ°ë° ì‹¬ì§€ì–´ ë‚˜ëŠ” íŠ¹ì • IPì™¸ì—ëŠ” ssh ì ‘ì†ì— ì‚¬ìš©ë˜ëŠ” í¬íŠ¸ì¸ 22ë¥¼ ec2ì—ì„œ ì—´ì–´ì£¼ì§€ë„ ì•ŠëŠ”ë‹¤**
- ê¹ƒí—™ì—ì„œ ì•„ë¬´ë ‡ê²Œë‚˜ ì ‘ê·¼í•˜ëŠ” ê²ƒì´ ê°€ëŠ¥í• ê¹Œ?
- AWSê°€ githubì „ì²´ë¥¼ ì—´ì–´ì£¼ëŠ” ë§ë„ì•ˆë˜ëŠ” ìœ ë™ì„±ì„ ê°€ì¡Œë‹¤ë©´ ê°€ëŠ¥í• ì§€ë„?..

# 3. ì‹œë ¨

EC2ì— ë³´ì•ˆê·¸ë£¹ìœ¼ë¡œ inboundë£°ì€ í•„ìˆ˜ë¼ ìƒê°í•˜ê¸°ì— ì„¤ì •ì„ í•´ë†“ì•˜ê³  ì´ ë£°ë¡œ timeoutì—ëŸ¬ê°€ ë‚˜ëŠ”ê²ƒìœ¼ë¡œ ê°œì¸ì ìœ¼ë¡œ í™•ì •ì„ í•˜ì˜€ë‹¤.

ë”°ë¼ì„œ, ê²€ìƒ‰ì„ í†µí•´ ì°¾ì•˜ë˜ í•´ë‹¹ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ì‘ì„±ëœ ìŠ¤í¬ë¦½íŠ¸ë‚˜ ì„¤ëª… ê¸€ë“¤ì€ ì•„ë§ˆë„ **í„°ë¯¸ë„ inboundë£°ì´ ì—†ëŠ” ìƒíƒœ**ì˜ ê²ƒì¸ ê²ƒìœ¼ë¡œ ìœ ì¶”í–ˆë‹¤.

ê·¸ëŸ¼ ì´ ì‘ì—…í•˜ë‚˜ë¥¼ ìœ„í•´ ë³´ì•ˆê·¸ë£¹ì„ í’€ìˆ˜ë„ ì—†ê³ , ê·¸ë ‡ë‹¤ê³  ê³„ì† ë™ì¼í•œ IPì£¼ì†Œë¡œ githubì—ì„œ í•´ë‹¹ ì¸ìŠ¤í„´ìŠ¤ë¡œ ì ‘ê·¼í•´ì£¼ëŠ” ê²ƒì´ ì•„ë‹ˆê¸°ì— ë³´ì•ˆê·¸ë£¹ì˜ ë£°ë§Œì„ ë³€ê²½í•œë‹¤ê³  í•´ê²°ë˜ëŠ” ì¼ì€ ì•„ë‹Œ ê²ƒì´ë¼ ìƒê°ë˜ì—ˆë‹¤.

ê·¸ë˜ì„œ ë˜ ì—´ì‹¬íˆ í•´ê²° ë°©ë²• ë””ê¹…ì„ ì‹œì‘í•˜ì˜€ë‹¤.

ì–´ì§¸ì €ì§¸, [`Self-hosted runner`](https://docs.github.com/en/actions/hosting-your-own-runners) ë¼ëŠ” í‚¤ì›Œë“œë¥¼ ì•Œê²Œ ë˜ì—ˆë‹¤.

## Self Hosted Runner

ê°„ë‹¨íˆ ê°œë…ë§Œ ë§í•˜ë©´, workflowë¥¼ Github ì—ì„œ ì œê³µí•˜ëŠ” ê°€ìƒë¨¸ì‹ ì´ ì•„ë‹ˆë¼, ìš°ë¦¬ê°€ ì§ì ‘ ì§€ì •í•œ í™˜ê²½ì—ì„œ ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤ëŠ” ëœ»ì´ë‹¤.

ì¦‰, ìš°ë¦¬ì˜ ec2 ì¸ìŠ¤í„´ìŠ¤ì—ì„œ íŠ¹ì • ì´ë²¤íŠ¸(íŠ¸ë¦¬ê±°)ê°€ ë°œìƒí•  ë•Œ ë§ˆë‹¤ workflowë¥¼ ì§ì ‘ ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤.

```md
ì‚¬ìš©ìëŠ” ìì²´ ì„œë²„, ê°€ìƒ ë¨¸ì‹  ë˜ëŠ” ë¬¼ë¦¬ì  ë¨¸ì‹ ì— self-hosted runnerë¥¼ ë“±ë¡í•˜ê³ ,
GitHub Actionsì—ì„œ ì‘ì—…ì„ ì‹¤í–‰í•  ë•Œ í•´ë‹¹ runnerë¥¼ ëŒ€ìƒìœ¼ë¡œ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ì´ë ‡ê²Œ í•˜ë©´ ì†ŒìŠ¤ ì½”ë“œì™€ ì‘ì—… ë°ì´í„°ê°€ ì‚¬ìš©ìê°€ ì†Œìœ í•œ í™˜ê²½ì—ì„œ ì•ˆì „í•˜ê²Œ ìœ ì§€ë  ìˆ˜ ìˆìœ¼ë©°,
ì‹¤í–‰ ì‹œê°„ê³¼ ìì›ì— ëŒ€í•œ ë” ë§ì€ ì œì–´ê¶Œì„ ê°€ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```

EC2ë‚´ì— Runnerë¥¼ ì„¤ì¹˜í•˜ê¸° ìœ„í•´ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ë°›ì•„ì™€ì•¼ í•˜ëŠ”ë°, í•´ë‹¹ ë ˆí¬ì§€í† ë¦¬ì˜ **Settings > Actions > Runners > New self-hosted runner**ë¥¼ í´ë¦­í•˜ë©´

![runner-install](../static/images/posts/blog-ci-cd/runner.png)

ì•„ë˜ì™€ ê°™ì€ Download íƒ€ì´í‹€ ì•„ë˜ ìŠ¤í¬ë¦½íŠ¸ê°€ ëœ¨ê²Œ ëœë‹¤.

ë‚˜ì˜ ì¸ìŠ¤í„´ìŠ¤ëŠ” ë¦¬ëˆ…ìŠ¤ì´ê¸°ì— ì„¸íŒ…ì— ë§ì¶° ì•„ë˜ ìŠ¤í¬ë¦½íŠ¸ë¥¼ í•´ë‹¹ ì¸ìŠ¤í„´ìŠ¤ì— ì ‘ì†í•˜ì—¬ ë³µì‚¬ ë¶™ì—¬ë„£ê¸° í•´ì£¼ë©´ ì•Œì•„ì„œ ì„¤ì¹˜ê°€ ì™„ë£Œëœë‹¤.

![runner-install](../static/images/posts/blog-ci-cd/runner-linux.png)

ìŠ¤í¬ë¦½íŠ¸ëŠ” `.shíŒŒì¼`ë¡œ ì¼ë°˜ì ìœ¼ë¡œ ì‹¤í–‰ì„í•˜ë©´ í„°ë¯¸ë„ì— ì ‘ì†ì„ ëŠëŠ”ê²½ìš° ì‹¤í–‰ì´ ë©ˆì¶”ê¸°ì— `nohup` ì´ë¼ëŠ” ëª…ë ¹ì–´ë¥¼ ì¶”ê°€ ì¡°í•©í•˜ì—¬ ì„¸ì…˜ì´ ëŠê²¨ë„ ê³„ì† ì§€ì†ì‹¤í–‰ì„ ì‹œì¼œì£¼ì–´ì•¼ í•œë‹¤.

ë‚˜ì˜ ê²½ìš°ëŠ” mainë¸Œëœì¹˜ì— í‘¸ì‰¬í•˜ëŠ” ê²½ìš° actionsë¥¼ ëŒë¦¬ê³  ì‹¶ì—ˆê¸°ì— ë”ë”ìš± í•„ìš”í•˜ì˜€ë‹¤.

ë”°ë¼ì„œ, `nohub ./run.sh &` ìœ¼ë¡œ ì‹¤í–‰ì„ ì‹œì¼œì£¼ì—ˆë‹¤.

![nohangup .shíŒŒì¼ í„°ë¯¸ë„ì—ì„œ ê³„ì† ë¦¬ìŠ¤ë‹í•˜ê¸° ìœ„í•´ì„œ](../static/images/posts/blog-ci-cd/run-on.png)

ê·¸ë ‡ê²Œ ì°¸ê³ í•˜ì—¬ ec2 ì¸ìŠ¤í„´ìŠ¤ì— ëŸ¬ë„ˆë„ ì˜¬ë¦¬ê³  ì•„ë˜ì™€ ê°™ì´ defaultsë„ ë³€ê²½í•˜ì—¬ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ë§Œë“¤ì—ˆì§€ë§Œ ì‘ë™ì„ í•˜ì§€ ì•Šì•˜ë‹¤.

ì—ëŸ¬ì½”ë“œì—ì„œëŠ” scriptê°€ ì—†ë‹¤ê³  í•œë‹¤.

```yml
# main.yml
name: main branch auto ci process script
on: # ì•„ë˜ jobì„ ì‹¤í–‰ì‹œí‚¬ ìƒí™©
  push:
    branches: [main] # mainë¸Œëœì¹˜ í‘¸ì‰¬ ë°›ìœ¼ë©´ ì‘ë™
jobs: # ì‘ë™í•  ì¼
  deploy:
    name: deploy #github ì•„ì´ì½˜ì— ë‚˜íƒ€ë‚  ê³¼ì • ì´ë¦„
    runs-on: self-hosted # GitHub Actionsì˜ ì¼ë¶€ë¡œ ì‚¬ìš©ì ì •ì˜ëœ ë¨¸ì‹ ìœ¼ë¡œ self-hosted runnerë¼ ë¶ˆë¦¼
    defaults:
      run:
        working-directory: ../..
    steps:
      - name: excuting remote ssh commands # ê° ë‹¨ê³„ ì´ë¦„
        uses: appleboy/ssh-action@v0.1.9 # ssh ì ‘ì†í•˜ëŠ” ì˜¤í”ˆì†ŒìŠ¤
        with:
          host: ${{ secrets.REMOTE_IP }} # ì¸ìŠ¤í„´ìŠ¤ IP
          username: ${{ secrets.REMOTE_ID }} # ìš°ë¶„íˆ¬ ì•„ì´ë””
          key: ${{ secrets.REMOTE_PEM }} # ec2 pem key
          port: ${{ secrets.REMOTE_SSH_PORT }} # ì ‘ì†í¬íŠ¸
          script: | # ì‹¤í–‰í•  ìŠ¤í¬ë¦½íŠ¸
            cd /home/ubuntu/Cloud-Vanilla-Blog/
            git pull origin main
            npm i
            pm2 kill
            npm run build:deploy
            pm2 start npm -- run start
```

# 4. ìµœì¢…

ì²˜ìŒì— ëŸ¬ë„ˆë¥¼ ì˜¬ë¦¬ê³  ìŠ¤í¬ë¦½íŠ¸ ìˆ˜ì •ì„ ë³„ ìƒê°ì—†ì´ ì¶”ê°€í•˜ë‹ˆ ë²Œì–´ì§„ ì‚¬íƒœ ê°™ì•˜ê³ , í•´ê²°ì„ ìœ„í•´ ìƒê°ì„ ì¡°ê¸ˆ í•˜ë‹¤ë³´ë‹ˆ

ì˜ ìƒê°í•´ë³´ë©´

- **self-hosted runner ê°€ ì‹¤ì œë¡œ ë¦¬ìŠ¤ë‹ì„ í•˜ê¸° ë•Œë¬¸ì— ë°”ë¡œ sshë¡œ ì ‘ì†ì„ í•  ìˆ˜ ìˆë„ë¡ ë„ì™€ì£¼ëŠ” ìƒíƒœì´ë‹¤.**
- **ê·¸ë ‡ë‹¤ë©´ ì˜¤í”ˆì†ŒìŠ¤ ë¼ì´ë¸ŒëŸ¬ë¦¬(appleboy/ssh-action@v0.1.9)ê°€ í•„ìš”ì—†ë‹¤.**
- **ê·¸ë¦¬ê³  ëŸ¬ë„ˆëŠ” ì¸ìŠ¤í„´ìŠ¤ì•ˆì—ì„œ ëŒì•„ê°€ë¯€ë¡œ ì˜¤í”ˆì†ŒìŠ¤ë¥¼ ì°¾ì§€ë„ ëª»í• ê²ƒìœ¼ë¡œ ìœ ì¶”ëœë‹¤(ì•„ë§ˆë„ ì—¬ê¸°ì„œ ìŠ¤í¬ë¦½íŠ¸ê°€ ì—†ë‹¤ê³  ëœ¨ëŠ” ê²ƒ ê°™ì•˜ë‹¤.)**
- **í„°ë¯¸ë„ ë‚´ì— ê¸°ì…í•  ì»¤ë§¨ë“œë§Œ ì‘ì„±í•˜ê³  ë¼ì´ë¸ŒëŸ¬ë¦¬ ê°€ì ¸ì˜¤ëŠ” ê²ƒì„ ì œê±°í•˜ë©´ ì‘ë™ì„ í•˜ëŠ”ê²Œ ì‘ë‹¹ ìƒì‹ì ìœ¼ë¡œ ë§ë‹¤ëŠ” ìƒê°ì´ ë“¤ì—ˆë‹¤.**

ê·¸ë˜ì„œ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš©ë¶€ë¶„ì„ ë¹¼ê³  ì»¤ë§¨ë“œì— ë„£ì„ ìŠ¤í¬ë¦½íŠ¸ë§Œ ìœ ì§€í•˜ë„ë¡ ë³€ê²½í•˜ì˜€ë‹¤.

ë³€ê²½í•˜ë©´ì„œ pm2 ê´€ë ¨ë¶€ë¶„ì„ ì¡°ê¸ˆ ì†ì„ë´¤ë‹¤.

êµ³ì´ ë‹¤ ì£½ì¼í•„ìš”ì—†ì´ restart í•˜ì—¬ë„ ë³€ê²½ëœ ì‚¬í•­ë“¤ì´ ë°˜ì˜ëœ ë’¤ ì¬ ì‹¤í–‰ì´ ëœë‹¤ê³  í•œë‹¤.

```yml
# main.yml
name: main branch auto ci process script

on: # ì•„ë˜ jobì„ ì‹¤í–‰ì‹œí‚¬ ìƒí™©
  push:
    branches: [main] # mainë¸Œëœì¹˜ í‘¸ì‰¬ ë°›ìœ¼ë©´ ì‘ë™

jobs: # ì‘ë™í•  ì¼
  deploy:
    runs-on: self-hosted # GitHub Actionsì˜ ì¼ë¶€ë¡œ ì‚¬ìš©ì ì •ì˜ëœ ë¨¸ì‹ ìœ¼ë¡œ self-hosted runnerë¼ ë¶ˆë¦¼
    defaults:
      run:
        working-directory: ../..
    steps:
      - name: Move folder and pull remote repository contents
        run: |
          cd /home/ubuntu/Cloud-Vanilla-Blog/
          git pull origin main
          npm i
          pm2 stop all
          npm run build:deploy
          pm2 restart all
```

ì•„ë˜ì™€ ê°™ì´ ì •ìƒì‘ë™í•˜ê²Œ ë˜ì—ˆê³  ì´ì œ ê¸€ì„ì“°ê³  pushë§Œí•˜ë©´ ì•Œì•„ì„œ ë¸”ë¡œê·¸ì— ë°˜ì˜ì´ ë˜ë„ë¡ ë§Œë“¤ì—ˆë‹¤.

ì´ì œ ë” ì—´ì‹¬íˆ ê¸€ì„ ì¨ë´ì•¼ê² ë‹¤. ğŸ˜…

![ì˜ ëŒì•„ê°€ëŠ” ì‚¬ì§„](../static/images/posts/blog-ci-cd/script-success.png)

## ì°¸ê³ 

- [Github Actionì„ ì´ìš©í•œ EC2 ìë™ë°°í¬ ì ìš©ê¸°](https://iamjooon2.tistory.com/25)
- [appleboy/ssh-action](https://github.com/appleboy/ssh-action#setting-up-ssh-key)
- [github Actions ë§Œìœ¼ë¡œ ì§€ì†ì  ë°°í¬(CD) ëª»í•˜ë‚˜?](https://velog.io/@bjk1649/github-Action-%EB%A7%8C%EC%9C%BC%EB%A1%9C-%EC%A7%80%EC%86%8D%EC%A0%81-%EB%B0%B0%ED%8F%ACCD-%EB%AA%BB%ED%95%98%EB%82%98)
- [nohup ëª…ë ¹ì–´ í™œìš©í•˜ê¸°](https://blog.acronym.co.kr/555)
